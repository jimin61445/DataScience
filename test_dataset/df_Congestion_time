import pandas as pd 
import numpy as np 

df_Congestion = pd.read_csv("original_dataset/dataset_Congestion.csv",encoding="cp949")
time_columns = [
    '5시30분', '6시00분', '6시30분', '7시00분', '7시30분', '8시00분', '8시30분', '9시00분',
    '9시30분', '10시00분', '10시30분', '11시00분', '11시30분', '12시00분', '12시30분',
    '13시00분', '13시30분', '14시00분', '14시30분', '15시00분', '15시30분', '16시00분',
    '16시30분', '17시00분', '17시30분', '18시00분', '18시30분', '19시00분', '19시30분',
    '20시00분', '20시30분', '21시00분', '21시30분', '22시00분', '22시30분', '23시00분',
    '23시30분', '00시00분', '00시30분']

df_Congestion_time = pd.DataFrame()
df_Congestion_time['출발역'] = df_Congestion['출발역']
df_Congestion_time['호선'] = df_Congestion['호선']
df_Congestion_time['상하구분'] = df_Congestion['상하구분']
df_Congestion_time['요일구분'] = df_Congestion['요일구분']
df_Congestion_time['5시xx분'] = df_Congestion[['5시30분', '6시00분']].sum(axis=1)
df_Congestion_time['6시xx분'] = df_Congestion[['6시30분', '7시00분']].sum(axis=1)
df_Congestion_time['7시xx분'] = df_Congestion[['7시30분', '8시00분']].sum(axis=1)
df_Congestion_time['8시xx분'] = df_Congestion[['8시30분', '9시00분']].sum(axis=1)
df_Congestion_time['9시xx분'] = df_Congestion[['9시30분', '10시00분']].sum(axis=1)
df_Congestion_time['10시xx분'] = df_Congestion[['10시30분', '11시00분']].sum(axis=1)
df_Congestion_time['11시xx분'] = df_Congestion[['11시30분', '12시00분']].sum(axis=1)
df_Congestion_time['12시xx분'] = df_Congestion[['12시30분', '13시00분']].sum(axis=1)
df_Congestion_time['13시xx분'] = df_Congestion[['13시30분', '14시00분']].sum(axis=1)
df_Congestion_time['14시xx분'] = df_Congestion[['14시30분', '15시00분']].sum(axis=1)
df_Congestion_time['15시xx분'] = df_Congestion[['15시30분', '16시00분']].sum(axis=1)
df_Congestion_time['16시xx분'] = df_Congestion[['16시30분', '17시00분']].sum(axis=1)
df_Congestion_time['17시xx분'] = df_Congestion[['17시30분', '18시00분']].sum(axis=1)
df_Congestion_time['18시xx분'] = df_Congestion[['18시30분', '19시00분']].sum(axis=1)
df_Congestion_time['19시xx분'] = df_Congestion[['19시30분', '20시00분']].sum(axis=1)
df_Congestion_time['20시xx분'] = df_Congestion[['20시30분', '21시00분']].sum(axis=1)
df_Congestion_time['21시xx분'] = df_Congestion[['21시30분', '22시00분']].sum(axis=1)
df_Congestion_time['22시xx분'] = df_Congestion[['22시30분', '23시00분']].sum(axis=1)
df_Congestion_time['23시xx분'] = df_Congestion[['23시30분', '00시00분']].sum(axis=1)
df_Congestion_time['00시이후'] = df_Congestion[['00시30분']]

print(df_Congestion_time.head())

def change_day(day):
    if day == 'Sunday':
        return '일요일'
    elif day == 'Saturday':
        return '토요일'
    else:
        return '평일'
    
df_Congestion_time['요일구분'] = df_Congestion_time['요일구분'].apply(change_day)

weekend_df = new_df_Congestion.loc[new_df_Congestion.index.get_level_values('요일구분').isin(['토요일', '일요일'])].reset_index()
weekend_avg = weekend_df.groupby(['5시xx분', '6시xx분', '7시xx분', '8시xx분', '9시xx분', '10시xx분', '11시xx분', '12시xx분',
                                  '13시xx분', '14시xx분', '15시xx분', '16시xx분', '17시xx분', '18시xx분', '19시xx분', '20시xx분'
                                 , '21시xx분', '22시xx분', '23시xx분', '00시이후']).mean().reset_index()
weekend_avg['요일구분'] = '주말'
weekday_df = new_df_Congestion.loc[new_df_Nop.index.get_level_values('요일구분') == '평일'].reset_index()

week_df = pd.concat([weekday_df, weekend_avg], ignore_index=True)
